<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kavak Log Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', 'Courier New', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: #2d2d30;
            padding: 20px;
            border-radius: 8px 8px 0 0;
            border-bottom: 3px solid #007acc;
        }

        h1 {
            color: #4ec9b0;
            font-size: 24px;
        }

        .controls {
            background: #252526;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            color: #9cdcfe;
            font-size: 12px;
        }

        input, select {
            background: #3c3c3c;
            border: 1px solid #555;
            color: #d4d4d4;
            padding: 8px;
            border-radius: 4px;
            font-family: inherit;
        }

        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        button:hover {
            background: #005a9e;
        }

        .log-output {
            background: #1e1e1e;
            border: 1px solid #555;
            padding: 20px;
            height: 500px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.6;
            border-radius: 0 0 8px 8px;
        }

        .log-line {
            margin-bottom: 4px;
            white-space: pre-wrap;
        }

        .log-info { color: #4fc1ff; }
        .log-warning { color: #dcdcaa; }
        .log-error { color: #f48771; }
        .log-debug { color: #608b4e; }
        .log-timestamp { color: #858585; }
        .log-service { color: #4ec9b0; }

        .stats {
            background: #2d2d30;
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4ec9b0;
        }

        .stat-label {
            font-size: 11px;
            color: #858585;
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            grid-column: 1 / -1;
        }

        .button-group button {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš— Kavak Log Generator</h1>
            <p style="color: #858585; margin-top: 5px;">Generate realistic automotive marketplace logs with bugs for analysis</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Log Lines to Generate</label>
                <input type="number" id="logCount" value="50" min="10" max="500">
            </div>

            <div class="control-group">
                <label>Bug Frequency (%)</label>
                <input type="number" id="bugFrequency" value="15" min="0" max="50">
            </div>

            <div class="control-group">
                <label>Service Type</label>
                <select id="serviceType">
                    <option value="all">All Services</option>
                    <option value="inventory">Inventory Service</option>
                    <option value="pricing">Pricing Engine</option>
                    <option value="payment">Payment Gateway</option>
                    <option value="inspection">Inspection API</option>
                    <option value="user">User Service</option>
                </select>
            </div>

            <div class="control-group">
                <label>Log Level</label>
                <select id="logLevel">
                    <option value="all">All Levels</option>
                    <option value="info">INFO</option>
                    <option value="warning">WARNING</option>
                    <option value="error">ERROR</option>
                    <option value="debug">DEBUG</option>
                </select>
            </div>

            <div class="button-group">
                <button onclick="generateLogs()">Generate Logs</button>
                <button onclick="downloadLogs()">Download Logs</button>
                <button onclick="clearLogs()">Clear</button>
            </div>
        </div>

        <div class="log-output" id="logOutput"></div>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalLogs">0</div>
                <div class="stat-label">TOTAL LOGS</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="errorCount">0</div>
                <div class="stat-label">ERRORS</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="warningCount">0</div>
                <div class="stat-label">WARNINGS</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="bugCount">0</div>
                <div class="stat-label">BUGS INJECTED</div>
            </div>
        </div>
    </div>

    <script>
        let allLogs = [];
        let stats = { total: 0, errors: 0, warnings: 0, bugs: 0 };

        const services = ['inventory-service', 'pricing-engine', 'payment-gateway', 'inspection-api', 'user-service'];
        
        const carBrands = ['Toyota', 'Honda', 'Nissan', 'Chevrolet', 'Ford', 'Volkswagen', 'BMW', 'Mercedes-Benz', 'Audi', 'Mazda'];
        const carModels = ['Corolla', 'Civic', 'Sentra', 'Aveo', 'Focus', 'Jetta', 'Serie 3', 'Clase C', 'A4', 'Mazda3'];
        
        const userIds = Array.from({length: 20}, (_, i) => `USR${String(i + 1000).padStart(6, '0')}`);
        const vehicleIds = Array.from({length: 30}, (_, i) => `VEH${String(i + 5000).padStart(6, '0')}`);
        const inspectionIds = Array.from({length: 15}, (_, i) => `INS${String(i + 2000).padStart(6, '0')}`);

        function getTimestamp() {
            const now = new Date();
            return now.toISOString();
        }

        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function shouldInjectBug() {
            const bugFreq = parseInt(document.getElementById('bugFrequency').value);
            return Math.random() * 100 < bugFreq;
        }

        function generateInventoryLog(level, hasBug) {
            const vehicleId = randomChoice(vehicleIds);
            const brand = randomChoice(carBrands);
            const model = randomChoice(carModels);
            const year = randomInt(2015, 2023);
            const price = randomInt(150000, 450000);

            const logs = [
                { level: 'info', msg: `Vehicle ${vehicleId} added to inventory: ${brand} ${model} ${year}, Price: $${price}` },
                { level: 'info', msg: `Fetching vehicle details for ${vehicleId}` },
                { level: 'warning', msg: `Vehicle ${vehicleId} has low mileage data quality score: 0.${randomInt(40, 69)}` },
                { level: 'error', msg: `Failed to update vehicle ${vehicleId}: Database connection timeout` },
            ];

            if (hasBug) {
                const bugLogs = [
                    { level: 'error', msg: `NullPointerException in getVehiclePrice() for ${vehicleId}: price field is null` },
                    { level: 'error', msg: `IndexOutOfBoundsException: trying to access image[5] but only 3 images available for ${vehicleId}` },
                    { level: 'warning', msg: `Memory leak detected: vehicle cache size exceeded 10GB, ${vehicleId} data not released` },
                    { level: 'error', msg: `SQL Injection attempt detected in search query: "' OR 1=1--" for brand=${brand}` },
                ];
                return randomChoice(bugLogs);
            }

            return level === 'all' ? randomChoice(logs) : logs.find(l => l.level === level) || logs[0];
        }

        function generatePricingLog(level, hasBug) {
            const vehicleId = randomChoice(vehicleIds);
            const basePrice = randomInt(150000, 450000);
            const finalPrice = basePrice + randomInt(-20000, 30000);

            const logs = [
                { level: 'info', msg: `Calculating price for ${vehicleId}: base=$${basePrice}, market_adjustment=${randomInt(-5, 10)}%` },
                { level: 'debug', msg: `ML model prediction for ${vehicleId}: confidence=0.${randomInt(75, 95)}` },
                { level: 'warning', msg: `Price volatility detected: ${vehicleId} price changed by ${randomInt(15, 35)}% in 24h` },
                { level: 'error', msg: `Failed to fetch market data for pricing: API timeout after 30s` },
            ];

            if (hasBug) {
                const bugLogs = [
                    { level: 'error', msg: `DivisionByZeroError in calculateDepreciation(): age parameter is 0 for ${vehicleId}` },
                    { level: 'error', msg: `Negative price calculated: ${vehicleId} final_price=-$${randomInt(5000, 15000)} (base: $${basePrice})` },
                    { level: 'error', msg: `TypeError: cannot multiply 'NoneType' by float in applyDiscount() for ${vehicleId}` },
                    { level: 'warning', msg: `Infinite loop detected in priceOptimization(): same price ${finalPrice} returned 1000+ times` },
                ];
                return randomChoice(bugLogs);
            }

            return level === 'all' ? randomChoice(logs) : logs.find(l => l.level === level) || logs[0];
        }

        function generatePaymentLog(level, hasBug) {
            const userId = randomChoice(userIds);
            const amount = randomInt(10000, 500000);
            const transactionId = `TXN${randomInt(100000, 999999)}`;

            const logs = [
                { level: 'info', msg: `Payment initiated: ${transactionId} for user ${userId}, amount=$${amount}` },
                { level: 'info', msg: `Payment ${transactionId} processed successfully via STRIPE` },
                { level: 'warning', msg: `Payment ${transactionId} flagged for manual review: high-risk transaction` },
                { level: 'error', msg: `Payment ${transactionId} declined: insufficient funds for user ${userId}` },
            ];

            if (hasBug) {
                const bugLogs = [
                    { level: 'error', msg: `Double charge detected: ${transactionId} processed twice for user ${userId}, amount=$${amount}` },
                    { level: 'error', msg: `JSONDecodeError: malformed webhook response from payment provider for ${transactionId}` },
                    { level: 'error', msg: `Race condition: concurrent payment updates for ${transactionId} caused data inconsistency` },
                    { level: 'error', msg: `Sensitive data leak: credit card number logged in plaintext for transaction ${transactionId}` },
                ];
                return randomChoice(bugLogs);
            }

            return level === 'all' ? randomChoice(logs) : logs.find(l => l.level === level) || logs[0];
        }

        function generateInspectionLog(level, hasBug) {
            const vehicleId = randomChoice(vehicleIds);
            const inspectionId = randomChoice(inspectionIds);
            const score = randomInt(65, 98);

            const logs = [
                { level: 'info', msg: `Inspection ${inspectionId} started for vehicle ${vehicleId}` },
                { level: 'info', msg: `Inspection ${inspectionId} completed: overall_score=${score}/100, status=APPROVED` },
                { level: 'warning', msg: `Inspection ${inspectionId}: minor issues detected - tire_wear=moderate, paint_scratch=3` },
                { level: 'error', msg: `Inspection ${inspectionId} failed to upload images: S3 bucket access denied` },
            ];

            if (hasBug) {
                const bugLogs = [
                    { level: 'error', msg: `ArrayIndexError: inspection checklist item[25] does not exist for ${inspectionId}` },
                    { level: 'error', msg: `Score calculation error: ${inspectionId} total=${score + 15} exceeds maximum of 100` },
                    { level: 'warning', msg: `Memory leak: inspection images for ${inspectionId} not freed, 500MB consumed` },
                    { level: 'error', msg: `Deadlock detected: inspection ${inspectionId} waiting for vehicle ${vehicleId} lock (timeout 300s)` },
                ];
                return randomChoice(bugLogs);
            }

            return level === 'all' ? randomChoice(logs) : logs.find(l => l.level === level) || logs[0];
        }

        function generateUserLog(level, hasBug) {
            const userId = randomChoice(userIds);
            const email = `user${randomInt(1000, 9999)}@kavak.com`;

            const logs = [
                { level: 'info', msg: `User ${userId} logged in from IP 187.${randomInt(1, 255)}.${randomInt(1, 255)}.${randomInt(1, 255)}` },
                { level: 'info', msg: `User profile updated: ${userId}, email=${email}` },
                { level: 'warning', msg: `Suspicious activity: user ${userId} attempted 5 logins in 2 minutes` },
                { level: 'error', msg: `Failed to authenticate user ${userId}: invalid token` },
            ];

            if (hasBug) {
                const bugLogs = [
                    { level: 'error', msg: `SQL error: duplicate key violation when creating user ${userId} (user already exists)` },
                    { level: 'error', msg: `AttributeError: 'NoneType' object has no attribute 'email' for user ${userId}` },
                    { level: 'warning', msg: `Session leak: user ${userId} has 47 active sessions, max limit is 5` },
                    { level: 'error', msg: `Authentication bypass: user ${userId} accessed admin panel without proper permissions` },
                ];
                return randomChoice(bugLogs);
            }

            return level === 'all' ? randomChoice(logs) : logs.find(l => l.level === level) || logs[0];
        }

        function generateLog() {
            const serviceType = document.getElementById('serviceType').value;
            const logLevel = document.getElementById('logLevel').value;
            const hasBug = shouldInjectBug();

            let service = serviceType === 'all' ? randomChoice(services) : serviceType + '-service';
            let logData;

            if (service.includes('inventory')) {
                logData = generateInventoryLog(logLevel, hasBug);
            } else if (service.includes('pricing')) {
                logData = generatePricingLog(logLevel, hasBug);
            } else if (service.includes('payment')) {
                logData = generatePaymentLog(logLevel, hasBug);
            } else if (service.includes('inspection')) {
                logData = generateInspectionLog(logLevel, hasBug);
            } else {
                logData = generateUserLog(logLevel, hasBug);
            }

            const timestamp = getTimestamp();
            const level = logData.level.toUpperCase();
            
            if (hasBug) stats.bugs++;
            if (level === 'ERROR') stats.errors++;
            if (level === 'WARNING') stats.warnings++;

            return {
                timestamp,
                level,
                service,
                message: logData.msg,
                raw: `[${timestamp}] ${level.padEnd(7)} [${service}] ${logData.msg}`
            };
        }

        function generateLogs() {
            const count = parseInt(document.getElementById('logCount').value);
            const output = document.getElementById('logOutput');
            
            stats = { total: 0, errors: 0, warnings: 0, bugs: 0 };
            allLogs = [];

            for (let i = 0; i < count; i++) {
                const log = generateLog();
                allLogs.push(log);
                stats.total++;

                const logLine = document.createElement('div');
                logLine.className = `log-line log-${log.level.toLowerCase()}`;
                logLine.innerHTML = `<span class="log-timestamp">[${log.timestamp}]</span> <span>${log.level.padEnd(7)}</span> <span class="log-service">[${log.service}]</span> ${log.message}`;
                output.appendChild(logLine);
            }

            output.scrollTop = output.scrollHeight;
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalLogs').textContent = stats.total;
            document.getElementById('errorCount').textContent = stats.errors;
            document.getElementById('warningCount').textContent = stats.warnings;
            document.getElementById('bugCount').textContent = stats.bugs;
        }

        function clearLogs() {
            document.getElementById('logOutput').innerHTML = '';
            allLogs = [];
            stats = { total: 0, errors: 0, warnings: 0, bugs: 0 };
            updateStats();
        }

        function downloadLogs() {
            if (allLogs.length === 0) {
                alert('No logs to download. Generate logs first.');
                return;
            }

            const logText = allLogs.map(log => log.raw).join('\n');
            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kavak_logs_${Date.now()}.log`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Generate initial logs
        window.onload = () => generateLogs();
    </script>
</body>
</html>